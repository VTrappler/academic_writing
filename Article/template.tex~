%% Copernicus Publications Manuscript Preparation Template for LaTeX Submissions
%% ---------------------------------
%% This template should be used for copernicus.cls
%% The class file and some style files are bundled in the Copernicus Latex Package, which can be downloaded from the different journal webpages.
%% For further assistance please contact Copernicus Publications at: production@copernicus.org
%% https://publications.copernicus.org/for_authors/manuscript_preparation.html


%% Please use the following documentclass and journal abbreviations for discussion papers and final revised papers.

%% 2-column papers and discussion papers
\documentclass[npg]{copernicus}



%% Journal abbreviations (please use the same for discussion papers and final revised papers)


% Advances in Geosciences (adgeo)
% Advances in Radio Science (ars)
% Advances in Science and Research (asr)
% Advances in Statistical Climatology, Meteorology and Oceanography (ascmo)
% Annales Geophysicae (angeo)
% Archives Animal Breeding (aab)
% ASTRA Proceedings (ap)
% Atmospheric Chemistry and Physics (acp)
% Atmospheric Measurement Techniques (amt)
% Biogeosciences (bg)
% Climate of the Past (cp)
% DEUQUA Special Publications (deuquasp)
% Drinking Water Engineering and Science (dwes)
% Earth Surface Dynamics (esurf)
% Earth System Dynamics (esd)
% Earth System Science Data (essd)
% E&G Quaternary Science Journal (egqsj)
% Fossil Record (fr)
% Geographica Helvetica (gh)
% Geoscientific Instrumentation, Methods and Data Systems (gi)
% Geoscientific Model Development (gmd)
% History of Geo- and Space Sciences (hgss)
% Hydrology and Earth System Sciences (hess)
% Journal of Micropalaeontology (jm)
% Journal of Sensors and Sensor Systems (jsss)
% Mechanical Sciences (ms)
% Natural Hazards and Earth System Sciences (nhess)
% Nonlinear Processes in Geophysics (npg)
% Ocean Science (os)
% Primate Biology (pb)
% Proceedings of the International Association of Hydrological Sciences (piahs)
% Scientific Drilling (sd)
% SOIL (soil)
% Solid Earth (se)
% The Cryosphere (tc)
% Web Ecology (we)
% Wind Energy Science (wes)


%% \usepackage commands included in the copernicus.cls:
%\usepackage[german, english]{babel}
%\usepackage{tabularx}
%\usepackage{cancel}
%\usepackage{multirow}
%\usepackage{supertabular}
%\usepackage{algorithmic}
%\usepackage{algorithm}
%\usepackage{amsthm}
%\usepackage{float}
%\usepackage{subfig}
%\usepackage{rotating}
\newcommand{\yobs}{\mathbf{y}^o}
\DeclareMathOperator*{\argmin}{arg\,min \,}
\DeclareMathOperator*{\argmax}{arg\,max \,}
\newcommand{\Var}{\mathbb{V}\text{ar}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\Cov}{\textsf{Cov}}
\newcommand{\tra}{\mathrm{tr}}
\begin{document}

\title{Robust estimation of parameters in the presence of random input}%TEXT}


% \Author[affil]{given_name}{surname}

\Author[]{Victor}{Trappler}
\Author[]{Ã‰lise}{Arnaud}
\Author[]{Arthur}{Vidard}

\affil[]{Univ. Grenoble Alpes, CNRS, Inria, Grenoble INP*, LJK, 38000 Grenoble, France}
% \affil[]{ADDRESS}

%% The [] brackets identify the author with the corresponding affiliation. 1, 2, 3, etc. should be inserted.



\runningtitle{Robust estimation in the presence of random inputs}

\runningauthor{Trappler V.}

\correspondence{Victor Trappler (victor.trappler@univ-grenoble-alpes.fr)}



\received{}
\pubdiscuss{} %% only important for two-stage journals
\revised{}
\accepted{}
\published{}

%% These dates will be inserted by Copernicus Publications during the typesetting process.


\firstpage{1}

\maketitle



\begin{abstract}
Classical methods of parameter estimation usually imply the minimisation of an objective function, that measures the error between some observations and the results obtained by a numerical model. In the presence of random inputs, the optimum is directly dependent on the fixed nominal value given to the uncertain parameter ; and therefore may not be relevant in other conditions.

In this paper, we are going to present strategies taking into account those uncertainties and apply them on an academic model of a coastal area, in order to find an optimal value in a robust sense.
\end{abstract}


\copyrightstatement{TEXT}


\introduction%% \introduction[modified heading if necessary]
\subsection{Motivation}
\cite{das_estimation_1991,das_variational_1992}
\subsection{State of the art}
\cite{kuczera_there_2010}

\section{Deterministic setting and limitations}
\subsection{Context and notations}
We assume that we have access to a computer code $\mathcal{M}$, simulating a physical phenomenon over a specific time window. This numerical model takes two types of inputs: a control variable, named $\mathbf{k} \in \mathcal{K}\subset \mathbb{R}^p$, and an environmental variable, named $\mathbf{u}\in\mathcal{U}\subset\mathbb{R}^l$. The control variable represents the quantities that are assumed to be constant, and comes from a lack of knowledge of the real physical settings. In the scope of our application, this parameter is the ocean bed friction induced by its rugosity. The environmental variables are the operating conditions, such as the boundary conditions. The output of the computer code is a physical quantity $\mathcal{M}(\mathbf{k},\mathbf{u})\in \mathcal{Y}$ (such as the sea surface height) that will be compared to an observation $\yobs$. In order to use this model, 

\subsection{Parameter calibration in a deterministic setting}
We assume that we dispose of an observation $\yobs$, that has been generated with a couple of unknowns $\mathbf{k}^t$ and $\mathbf{u}^t$ (where $(\cdot)^t$ stands for ``truth''): $\yobs=  \mathcal{M}(\mathbf{k}^t, \mathbf{u}^t)$. We also assume that we have background values for $\mathbf{k}$ and $\mathbf{u}$: $\mathbf{k}^b$ and $\mathbf{u}^b$. Calibration in this setting boils down to the minimisation of the cost function $J$ defined by
\begin{align}
  \label{eq:def_cost_fun}
  J(\mathbf{k}) &= \frac12(\mathcal{M}(\mathbf{k},\mathbf{u}^b) - \yobs)^T \mathbf{R}^{-1}  (\mathcal{M}(\mathbf{k},\mathbf{u}^b)-\yobs) \nonumber\\
                & \quad +\frac12 (\mathbf{k}-\mathbf{k}^b)^T \mathbf{B}^{-1} (\mathbf{k}-\mathbf{k}^b) \nonumber \\
                & = \frac12\|\mathcal{M}(\mathbf{k},\mathbf{u}^b) - \yobs \|_{\mathbf{R}^{-1}}^2 + \frac12\|\mathbf{k}-\mathbf{k}^b\|_{\mathbf{B}^{-1}}^2 
\end{align}
and after minimization,
\begin{equation}
  \label{eq:khat_def}
  J(\hat{\mathbf{k}}) = \min_{\mathbf{k} \in \mathcal{K}} J(\mathbf{k})
\end{equation}
Minimizing $J$ will indeed compensate the error introduced by the parametrization $\mathbf{k}$, but will also compensate another misspecification: choosing $\mathbf{u}^b$ instead of $\mathbf{u}^t$ in the computer code.
In the end, the value $\hat{\mathbf{k}}$ obtained will be optimal for this configuration. However, if the operating conditions do change, we do not have any information on the performance of $\hat{\mathbf{k}}$ in another setting. The solution to jointly estimate $\mathbf{k}$ and $\mathbf{u}$.

\section{Probabilistic point of view}
We model the environmental variables as a random variable: $\mathbf{U}$ whose sample space is $\mathcal{U}$. The probability measure of $\mathbf{U}$ is $\Prob_U$, and its density, if it exists, is $p_U$.
\subsection{The cost function as a random variable}
In this case, the cost function defined in~\eqref{eq:def_cost_fun} is no longer a function of solely $\mathbf{k}$, but of $\mathbf{U}$ as well:
\begin{equation}
  \label{eq:def_cost_fun_rnd}
  J(\mathbf{k},\mathbf{U}) = \frac12 \| \mathcal{M}(\mathbf{k},\mathbf{U}) - \yobs \|^2_{\mathbf{R}^{-1}} + \frac12\|\mathbf{k}-\mathbf{k}^b\|_{\mathbf{B}^{-1}}^2 
\end{equation}

\subsection{Definitions of robustness}
Robustness does have a lot of meanings, especially in the probabilities and statistics community. Indeed, a definition of the robustness of an estimator is a measure of the sensibility of said estimator to outliers~\citep{huber_robust_2011}. In other cases, robustness in a Bayesian framework refers to the sentivity of a wrong specification of the priors~\citep{berger_overview_1994}.
In this paper, we are going to focus on two different aspects:
\begin{itemize}
\item Optimisation of the mean response (M-robustness in~\cite{lehman_designing_2004})
  \begin{equation}
    \label{eq:def_opt_mean}
    \text{minimize : } \Ex_U\left[J(\mathbf{k},\mathbf{U})\right] = \int_{\mathcal{U}} J(\mathbf{k},\mathbf{u}) \,\mathrm{d}\Prob_U(\mathbf{u}) = \int_{\mathcal{U}} J(\mathbf{k},\mathbf{u})p_U(\mathbf{u}) \,\mathrm{d}\mathbf{u}
  \end{equation}
\item Study of the distribution of the minimizers, assuming the inverse problem is well-posed to ensure the existence and the unicity of the $\argmin$
  \begin{equation}
    \label{eq:def_study_minimizers}
    \mathbf{K}_{\mathrm{opt}}=\argmin_{\mathbf{k}\in\mathcal{K}} J(\mathbf{k},\mathbf{U}) 
  \end{equation}
  It is worth noting that this distribution can be rewritten closer to a reliability formulation:
  \begin{equation}
    \label{eq:def_Kopt_reliability}
    p_{K_{\mathrm{opt}}}(\mathbf{k}) \propto \Prob_U\left[J(\mathbf{k},\mathbf{U}) \leq \min_{\tilde{\mathbf{k}}\in\mathcal{K}}J(\tilde{\mathbf{k}},\mathbf{U}) \right]
  \end{equation}
\end{itemize}
\section{Methods and applications}
\subsection{Optimisation of the mean response}
\cite{janusevskis_simultaneous_2010}, \cite{miranda_adjoint-based_2016}


\conclusions  %% \conclusions[modified heading if necessary]
TEXT

%% The following commands are for the statements about the availability of data sets and/or software code corresponding to the manuscript.
%% It is strongly recommended to make use of these sections in case data sets and/or software code have been part of your research the article is based on.

\codeavailability{TEXT} %% use this section when having only software code available


\dataavailability{TEXT} %% use this section when having only data sets available


\codedataavailability{TEXT} %% use this section when having data sets and software code available


\sampleavailability{TEXT} %% use this section when having geoscientific samples available



\appendix
\section{}    %% Appendix A

\subsection{}     %% Appendix A1, A2, etc.


\noappendix       %% use this to mark the end of the appendix section

%% Regarding figures and tables in appendices, the following two options are possible depending on your general handling of figures and tables in the manuscript environment:

%% Option 1: If you sorted all figures and tables into the sections of the text, please also sort the appendix figures and appendix tables into the respective appendix sections.
%% They will be correctly named automatically.

%% Option 2: If you put all figures after the reference list, please insert appendix tables and figures after the normal tables and figures.
%% To rename them correctly to A1, A2, etc., please add the following commands in front of them:

\appendixfigures  %% needs to be added in front of appendix figures

\appendixtables   %% needs to be added in front of appendix tables

%% Please add \clearpage between each table and/or figure. Further guidelines on figures and tables can be found below.



\authorcontribution{TEXT} %% it is strongly recommended to make use of this section

\competinginterests{TEXT} %% this section is mandatory even if you declare that no competing interests are present

\disclaimer{TEXT} %% optional section

\begin{acknowledgements}
TEXT
\end{acknowledgements}




%% REFERENCES

%% The reference list is compiled as follows:

% \begin{thebibliography}{}

% \bibitem[AUTHOR(YEAR)]{LABEL1}
% REFERENCE 1

% \bibitem[AUTHOR(YEAR)]{LABEL2}
% REFERENCE 2

% \end{thebibliography}

%% Since the Copernicus LaTeX package includes the BibTeX style file copernicus.bst,
%% authors experienced with BibTeX only have to include the following two lines:
%%
\bibliographystyle{copernicus}
\bibliography{../Documents/bibzotero.bib}
%%
%% URLs and DOIs can be entered in your BibTeX file as:
%%
%% URL = {http://www.xyz.org/~jones/idx_g.htm}
%% DOI = {10.5194/xyz}


%% LITERATURE CITATIONS
%%
%% command                        & example result
%% \citet{jones90}|               & Jones et al. (1990)
%% \citep{jones90}|               & (Jones et al., 1990)
%% \citep{jones90,jones93}|       & (Jones et al., 1990, 1993)
%% \citep[p.~32]{jones90}|        & (Jones et al., 1990, p.~32)
%% \citep[e.g.,][]{jones90}|      & (e.g., Jones et al., 1990)
%% \citep[e.g.,][p.~32]{jones90}| & (e.g., Jones et al., 1990, p.~32)
%% \citeauthor{jones90}|          & Jones et al.
%% \citeyear{jones90}|            & 1990



%% FIGURES

%% When figures and tables are placed at the end of the MS (article in one-column style), please add \clearpage
%% between bibliography and first table and/or figure as well as between each table and/or figure.


%% ONE-COLUMN FIGURES

%%f
%\begin{figure}[t]
%\includegraphics[width=8.3cm]{FILE NAME}
%\caption{TEXT}
%\end{figure}
%
%%% TWO-COLUMN FIGURES
%
%%f
%\begin{figure*}[t]
%\includegraphics[width=12cm]{FILE NAME}
%\caption{TEXT}
%\end{figure*}
%
%
%%% TABLES
%%%
%%% The different columns must be seperated with a & command and should
%%% end with \\ to identify the column brake.
%
%%% ONE-COLUMN TABLE
%
%%t
%\begin{table}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{table}
%
%%% TWO-COLUMN TABLE
%
%%t
%\begin{table*}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{table*}
%
%%% LANDSCAPE TABLE
%
%%t
%\begin{sidewaystable*}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{sidewaystable*}
%
%
%%% MATHEMATICAL EXPRESSIONS
%
%%% All papers typeset by Copernicus Publications follow the math typesetting regulations
%%% given by the IUPAC Green Book (IUPAC: Quantities, Units and Symbols in Physical Chemistry,
%%% 2nd Edn., Blackwell Science, available at: http://old.iupac.org/publications/books/gbook/green_book_2ed.pdf, 1993).
%%%
%%% Physical quantities/variables are typeset in italic font (t for time, T for Temperature)
%%% Indices which are not defined are typeset in italic font (x, y, z, a, b, c)
%%% Items/objects which are defined are typeset in roman font (Car A, Car B)
%%% Descriptions/specifications which are defined by itself are typeset in roman font (abs, rel, ref, tot, net, ice)
%%% Abbreviations from 2 letters are typeset in roman font (RH, LAI)
%%% Vectors are identified in bold italic font using \vec{x}
%%% Matrices are identified in bold roman font
%%% Multiplication signs are typeset using the LaTeX commands \times (for vector products, grids, and exponential notations) or \cdot
%%% The character * should not be applied as mutliplication sign
%
%
%%% EQUATIONS
%
%%% Single-row equation
%
%\begin{equation}
%
%\end{equation}
%
%%% Multiline equation
%
%\begin{align}
%& 3 + 5 = 8\\
%& 3 + 5 = 8\\
%& 3 + 5 = 8
%\end{align}
%
%
%%% MATRICES
%
%\begin{matrix}
%x & y & z\\
%x & y & z\\
%x & y & z\\
%\end{matrix}
%
%
%%% ALGORITHM
%
%\begin{algorithm}
%\caption{...}
%\label{a1}
%\begin{algorithmic}
%...
%\end{algorithmic}
%\end{algorithm}
%
%
%%% CHEMICAL FORMULAS AND REACTIONS
%
%%% For formulas embedded in the text, please use \chem{}
%
%%% The reaction environment creates labels including the letter R, i.e. (R1), (R2), etc.
%
%\begin{reaction}
%%% \rightarrow should be used for normal (one-way) chemical reactions
%%% \rightleftharpoons should be used for equilibria
%%% \leftrightarrow should be used for resonance structures
%\end{reaction}
%
%
%%% PHYSICAL UNITS
%%%
%%% Please use \unit{} and apply the exponential notation


\end{document}
